<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Crear Operador</title>
  <link rel="stylesheet" href="styles-admin.css">
</head>
<body>
  <h1>Crear Operadores</h1>

  <form id="form-crear-operador">
    <label>Zona:</label>
    <input type="text" id="zona" required placeholder="Ej: Quilmes">

    <label>Cantidad de operadores:</label>
    <input type="number" id="cantidad" min="1" required>

    <label>Nombre base del usuario:</label>
    <input type="text" id="nombreBase" required placeholder="Ej: operadorquilmes">

    <button type="submit">Crear operadores</button>
    <button type="button" onclick="window.location.href='index-admin.html'">Volver</button>
  </form>

  <div id="resultado-operadores"></div>

  <script>
    // 游댏 Generador de contrase침a
    function generarContrase침a() {
      return Math.floor(1000 + Math.random() * 9000).toString();
    }

    // 游녻 Crear m칰ltiples operadores
    document.getElementById('form-crear-operador').addEventListener('submit', async (e) => {
      e.preventDefault();

      const zona = document.getElementById('zona').value.trim();
      const cantidad = parseInt(document.getElementById('cantidad').value);
      const nombreBase = document.getElementById('nombreBase').value.trim();
      const empresa_id = sessionStorage.getItem('empresaId');
      const emailAdmin = sessionStorage.getItem('adminEmail');

      let resultadoHTML = `<h3>Operadores creados:</h3><ul>`;

      for (let i = 1; i <= cantidad; i++) {
        const username = `${nombreBase}${i}`;
        const password = generarContrase침a();

        try {
          const response = await fetch('/api/crear-operador', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ username, password, zona, empresa_id, emailAdmin })
          });

          if (response.ok) {
            resultadoHTML += `<li>${username} - Contrase침a: ${password}</li>`;
          } else {
            resultadoHTML += `<li style="color:red">${username} - Error al crear</li>`;
          }
        } catch (error) {
          resultadoHTML += `<li style="color:red">${username} - Error de conexi칩n</li>`;
        }
      }

      resultadoHTML += `</ul>`;
      document.getElementById('resultado-operadores').innerHTML = resultadoHTML;
    });
  </script>
</body>
</html>

